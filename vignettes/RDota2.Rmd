---
title: "RDota2"
author: "Theo Boutaris"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Documentation and Examples for RDota2}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo = FALSE}
NOT_CRAN <- identical(tolower(Sys.getenv("NOT_CRAN")), "true")
knitr::opts_chunk$set(purl = NOT_CRAN)
```

RDota2 is an R Steam API client for Valve's game Dota2. 

In order to use the package you will need to have a Steam Key which you can get from [Steam Community](https://steamcommunity.com/login/home/?goto=%2Fdev%2Fapikey). You will also need a Steam account in order to request a key.

## Usage

The typical workflow of RDota2 would include registering a key on R and then using the get_* family functions to access the API.

#### Registering a key on R

The typical way of working with RDota2 is to register a key on R (**once in every section**) and then that key will automatically be used within each one of the get_* family functions.

In order to register a key on R you need to use the `key_actions` function in the following way:

```{R, eval = NOT_CRAN}
#load installed package 
library(RDota2)

#register key on R. xxxxxx is the key you received from Steam.
key_actions(action = 'register_key', value = 'xxxxxxxx')
```

Instead of specifying the key on your console / script (where it would be visible to anyone), good practice dictates to save it in an environment variable. This is a very easy to do process and you only need to do it once. The key will always be made easily available in your R sessions after this. In order to store the key in an environment variable you would need to do the following: 

1. Identify your home directory. If you don't know which one it is just run `normalizePath("~/")` in the R console. 
2. In your home directory create a file called .Renviron (it shouldn't have an extension, like for example .txt). If questioned, YES you do want to use a file name that begins with a dot. Note that by default dotfiles are usually hidden. But within RStudio, the file browser will make .Renviron visible and therefore easy to edit in the future.
3. In the .Renviron file type a line like `RDota_KEY=xxxxxxxx`, where RDota_KEY will be the name of the R environment variable and xxxxxxxx will be your individual Steam API Key. Make sure the last line in the file is empty (if it isn’t R will silently fail to load the file). If you’re using an editor that shows line numbers, there should be two lines, where the second one is empty.
4. Restart your R session if you were using one, since .Renviron is parsed at the start of an R session.
5. Access the key on your R session using `Sys.getenv`.

So, the best practice would be to register your key in the following way:

```{R, eval = NOT_CRAN}
#load installed package 
library(RDota2)

#register key on R. Sys.getenv('RDota_KEY') will retrieve the value of the  
#RDota_KEY environment variable which is saved in your .Renviron file.
key_actions(action = 'register_key', value = Sys.getenv('RDota_KEY'))

#now you can use any of the get_*family functions without specifying a key e.g.
heroes <- get_heroes()
head(heroes$content)
```

Each of the `get_*` family functions has a key argument which should only be used if you work with multiple keys. 

## get_* Family Funtions

The get_* family functions are the functions used to access the API. They map the following API methods:

Dota 2 methods relating to match information:

* GetLeagueListing    
  Information about DotaTV-supported leagues.
* GetLiveLeagueGames    
  A list of in-progress league matches, as well as details of that match as it unfolds.
* GetMatchDetails    
  Information about a particular match.
* GetMatchHistory    
  A list of matches, filterable by various parameters.
* GetMatchHistoryBySequenceNum     
  A list of matches ordered by their sequence num.
* GetScheduledLeagueGames     
  A list of scheduled league games coming up.
* GetTeamInfoByTeamID     
  A list of all the teams set up in-game.
* GetTournamentPlayerStats     
  Stats about a particular player within a tournament.
* GetTopLiveGame     

Dota 2 methods relating to Dota 2 economy:

* GetGameItems     
  Dota 2 In-game items
* GetItemIconPath     
* GetHeroes     
  A list of heroes within Dota 2.
* GetRarities     
  Dota 2 item rarity list.
* GetTournamentPrizePool      
  The current prizepool for specific tournaments.
* GetEventStatsForAccount     

You can access the Steam API Documentation from [this link](https://wiki.teamfortress.com/wiki/WebAPI).

All get_* functions have three common arguments that can be used:

* key - This is to be used only in the case of working with multiple keys. If you work with just one key please 
  follow the procedure of using an R environment variable, which is described in detail above.
* language - This is the ISO639-1 code for all languages. You can select whichever you like. The default language is
  'en' which corresponds to english. If the language chosen is not supported, english will be returned.
* dota_id - This can take just tree values according to the Dota App ID. 570 for Dota2, 816 for Dota internal test and
  205790 for Dota 2 (beta) test. 570 is the default one.

Moreover, all get_* functions will return a `dota_api` object that contains 3 elements:

* url - The request url (without showing the key).
* content - This is the useful element to the user, since it contains Dota2 data.
* response - This shows information about the response retrieved from steam like headers, status, cookies, date, etc. 

By default when printing a `dota_api` object **only the content element will be printed on screen**.

The above are true for all the get_* functions, so they will not be analysed in detail in the individual function 
demonstration that follows.

### get_league_listing 
```{R, echo = FALSE, eval = NOT_CRAN}
key_actions('register_key', value = Sys.getenv('RDota_KEY'))
```
`get_league_listing` returns information about Dota TV-supported leagues 







